package coding_test;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class programmers_1830_retry {

    public static void main(String[] args) throws IOException {
        BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
//        System.out.println("result ==> " + " " + solution(bf.readLine()));

        System.out.println("A BBBB CC D D D"+ " / " + solution("aAaBbBbBbBcCCcDdDdD"));
        System.out.println("HELLO"+ " / " + solution("aHELLOa"));
        System.out.println("A A A A AA"+ " / " + solution("AAAAxAbAx"));
        System.out.println("HELLO"+ " / " + solution("aHbEbLbLbOa"));
        System.out.println("HELLO WORLD"+ " / " + solution("HaEaLaLaObWORLDb"));
        System.out.println("SIGONG J O A"+ " / " + solution("SpIpGpOpNpGJqOqA"));
        System.out.println("A"+ " / " + solution("A"));
        System.out.println("H E L L O W O R L D"+ " / " + solution("HELLOWORLD"));
        System.out.println("HELLO WORLD"+ " / " + solution("aHbEbLbLbOacWdOdRdLdDc"));
        System.out.println("HELL O WORLD"+ " / " + solution("HaEaLaLObWORLDb"));
        System.out.println("A A A"+ " / " + solution("AAA"));
        System.out.println("HELLOWORLD"+ " / " + solution("aHELLOWORLDa"));
        System.out.println("A A A B A BBBB C BBBB C BB GG G G G RRRRRR"
                + " / " + solution("AAAaBaAbBBBBbCcBdBdBdBcCeBfBeGgGGjGjGRvRvRvRvRvR"));
        System.out.println("I A M"+ " / " + solution("aIaAM"));
        System.out.println("AO"+ " / " + solution("bAaOb"));
        System.out.println("invalid"+ " / " + solution("a"));
        System.out.println("invalid"+ " / " + solution("Aa"));
        System.out.println("invalid"+ " / " + solution("aA"));
        System.out.println("invalid"+ " / " + solution("HaEaLaLaOWaOaRaLaD"));
        System.out.println("invalid"+ " / " + solution("abHELLObaWORLD"));
        System.out.println("invalid"+ " / " + solution("aHELLOa bWORLDb"));
        System.out.println("invalid"+ " / " + solution("TxTxTxbAb"));
        System.out.println("invalid"+ " / " + solution("bTxTxTaTxTbkABaCDk"));
        System.out.println("invalid"+ " / " + solution("baHELLOabWORLD"));
        System.out.println("invalid"+ " / " + solution("A B"));
        System.out.println("AAAA BBBB"+ " / " + solution("AxAxAxABcBcBcB"));
        System.out.println("BB A"+ " / " + solution("oBBoA"));
        System.out.println("AAAA"+ " / " + solution("AxAxAxA"));
        System.out.println("HELLO WORLD SIGONG J O A GWFD GWL BB A A A AAAA A"
                + " / " + solution("HaEaLaLaObWORLDbSpIpGpOpNpGJqOqAdGcWcFcDdeGfWfLeoBBoAAAAxAxAxAA"));
        System.out.println("BA DE A E EEEE"+ " / " + solution("aBcAadDeEdvAvlElmEEEEm"));
        System.out.println("A A A B B B"+ " / " + solution("AcAcABaBaB"));
        System.out.println("GWFD GWL"+ " / " + solution("aGbWbFbDakGnWnLk"));
        System.out.println("X XX X"+ " / " + solution("XcXbXcX"));
        System.out.println("invalid"+ " / " + solution("aCaCa"));
        System.out.println("invalid"+ " / " + solution("AxAxAxAoBoBoB"));
//        System.out.println("A"+ " / " + solution("aaA"));
//        System.out.println("A"+ " / " + solution("Aaa"));
        System.out.println("invalid"+ " / " + solution("xAaAbAaAx"));
        System.out.println("invalid"+ " / " + solution("AsCsWsQsQsEEEEEEEEeEeEe"));
        System.out.println("A B C D E F GH"+ " / " + solution("ABCaDaEFGbH"));
        System.out.println("A B B B AAA"+ " / " + solution("aAaBBBcAeAeAc"));
        System.out.println("A B C DEF H I"+ " / " + solution("ABCbDaEaFbHI"));
        System.out.println("invalid"+ " / " + solution("AacacaA"));
        System.out.println("invalid"+ " / " + solution("AaBcBcBcBcB"));
        System.out.println("invalid"+ " / " + solution("aAAA"));
        System.out.println("invalid"+ " / " + solution("AAAa"));
        System.out.println("invalid"+ " / " + solution("aAbBBbAa"));
        System.out.println("invalid"+ " / " + solution("aAbBBbAa"));
        System.out.println("invalid"+ " / " + solution("aAAbBbAAa"));
        System.out.println("invalid"+ " / " + solution("aAcAbAbAcAcAcAa"));
        System.out.println("invalid"+ " / " + solution("acAcAcAa"));
        System.out.println("invalid"+ " / " + solution("aAcAcAca"));
        System.out.println("A AAA A"+ " / " + solution("AdAeAeAdA"));
        System.out.println("invalid"+ " / " + solution("dAAeAd"));
        System.out.println("invalid"+ " / " + solution("dAeAAd"));
        System.out.println("ABA"+ " / " + solution("cAbBbAc"));
        System.out.println("invalid"+ " / " + solution("AbbA"));
        System.out.println("invalid"+ " / " + solution("aAaaBa"));
        System.out.println("A B"+ " / " + solution("aAacBc"));
        System.out.println("A B"+ " / " + solution("AB"));
        System.out.println("A B"+ " / " + solution("AcBc"));
        System.out.println("A B"+ " / " + solution("aAaB"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAbAbAbAacBdBdBdBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("AbAbAbABdBdBdB"));
        System.out.println("AAAA BBBB"+ " / " + solution("AbAbAbAcBBBBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAbAbAbAaBdBdBdB"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAbAbAbAacBBBBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAaBdBdBdB"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAacBBBBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAaBdBdBdB"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAacBdBdBdBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAaBdBdBdB"));
        System.out.println("AAAA BBBB"+ " / " + solution("AbAbAbAcBdBdBdBc"));
        System.out.println("AAAA BBBB"+ " / " + solution("aAAAAaBdBdBdB"));
        System.out.println("IM M M"+ " / " + solution("IaMMbMb"));
        System.out.println("invalid"+ " / " + solution("AaAaAabBBb"));
        System.out.println("A A AA"+ " / " + solution("AaAaAcA"));
        System.out.println("A B"+ " / " + solution("aAabBb"));
        System.out.println("B HEE"+ " / " + solution("bBbcHdEdEc"));
        System.out.println("AA A"+ " / " + solution("AaAA"));
        System.out.println("J OOO A"+ " / " + solution("JaOOOaA"));
        System.out.println("J O O O A"+ " / " + solution("aJaOOOcAc"));
        System.out.println("I AM"+ " / " + solution("IaAMa"));
        System.out.println("I A M"+ " / " + solution("aIaAM"));
        System.out.println("SIGONG J OOO A"+ " / " + solution("SpIpGpOpNpGJqOOOqA"));
        System.out.println("invalid"+ " / " + solution("AxAxAxAoBoBoB"));
        System.out.println("HELLO WORLD"+ " / " + solution("HaEaLaLaOWbObRbLbD"));
        System.out.println("AAAA B B B"+ " / " + solution("AxAxAxABoBoB"));
        System.out.println("B"+ " / " + solution("aBa"));
        System.out.println("invalid"+ " / " + solution("baHELLOabWORLD"));
        System.out.println("invalid"+ " / " + solution("aAbAba"));
        System.out.println("AO"+ " / " + solution("bAaOb"));
        System.out.println("A A A B B B BB"+ " / " + solution("AAAaBaBBBbB"));
    }

    public static String solution(String sentence) throws IOException {
        String answer = "";
        // 테스트케이스 + 질문하기 예제 모두 통과되는데 제출은 안됨;;
        // bBbcHdEdEc

        /*
     앞에서 거를 것 : 공백 포함 -> 완료
         규칙1 : 처음과 끝 -> 첫 문자의 다음, 끝 문자의 앞은 대문자
            규칙 1 안에 소문자 2개가 있는 경우 규칙 1이 두번 적용된 걸로 나오지만, 오류는 나지 않음
         규칙2 : 글자 사이사이 -> 모든 소문자의 앞 뒤는 대문자

         추가규칙 : 한 단어에 같은 규칙은 여러번 x

         --> 글자는 무조건 1개 or 2개 or 3개이상 -> 1 or 3 이상 : 규칙 2, 2 : 규칙 1

         function
            1. 소문자 갯수 구하는 함수 -
                count_char
            2. 앞 & 뒤 혹은 앞 | 뒤 대문자 확인 -
                check_AZ
                    if 2 : 앞의 뒤, 뒤의 앞,
                    else : 앞뒤
            3. 한 문자에 같은 규칙이 있는지 판단
                check_only
                    if 2 : 사이에 소문자가 1개 이하인자 + 안에 소문자인 게 2개면 안됨
                    else : indexof와 lastindexof 사이에 다른 문자가 있는지
            4. 1~3 했을 때 invalid가 아닐 경우 문자열 수정하기
                made_answer
                    if 2 : 앞 뒤 둘 다 replace(" ")
                    else : 소문자 다 지우고 첫 인덱스 앞을 " " + 첫 인덱스, 마지막 인덱스 뒤를 마지막 인덱스 + " "
            finally -
                공백 여러개 다 하나로 치환
                    replace(" +", " ")
                    맨 앞 맨 뒤 공백 삭제

        */

        if (sentence.contains(" ")) return "invalid";
        if (sentence.length() == 1) {
            if (Character.isUpperCase(sentence.charAt(0))) {
                return sentence;
            } else {
                return "invalid" ;
            }
        }
        StringBuilder builder = new StringBuilder(sentence);

        boolean end = false;
        int index = 0;

        while (!end) {

            if (Character.isLowerCase(builder.charAt(index))) {
                char key = builder.charAt(index);

                int count = count_char(builder, key);

//                if (count == 1) {
                    if(check_AZ(builder, index, count)) {
                        if (check_only(builder, index, count)) {
                            made_answer(builder, index, count);
                        } else {
                            return "invalid";
                        }
                    } else {
                        return "invalid";
                    }
//                } else if (count == 2) {
//                    if(check_AZ(builder, index, count)) {
//
//                    } else {
//                        return "invalid";
//                    }
//                } else {
//                    if(check_AZ(builder, index, count)) {
//
//                    } else {
//                        return "invalid";
//                    }
//                }
            }
            index++;
            if (index == builder.length()) end = true;
        }

        if (builder.charAt(0) == ' ') builder.deleteCharAt(0);
        if (builder.charAt(builder.length()-1) == ' ') builder.deleteCharAt(builder.length()-1);
        answer = builder.toString().trim().replaceAll(" +", " ");

        return answer;
    }

    private static int count_char(StringBuilder builder, char key) {
        int count = 0;

        for (int i = 0; i < builder.length(); i++) {
            if (builder.charAt(i) == key) count++;
        }

        return count;
    }

    private static boolean check_AZ(StringBuilder builder, int index, int count) {

        int index_first = index;
        int index_last = builder.lastIndexOf(builder.charAt(index)+"");

        if (count == 2) {
            if (Character.isUpperCase(builder.charAt(index_first+1))
                    && Character.isUpperCase(builder.charAt(index_last-1))) {
                return true;
            } else {
                return false;
            }
        } else {

            for (int i = 0; i < count; i++) {
                index_first = index + (i * 2);

                if (index_first == 0 || index_first == builder.length()-1) return false;

                if (index_first == 0) {
                    if (!(Character.isUpperCase(builder.charAt(index_first+1)))) {
                        return false;
                    }
                } else if (index_first == builder.length()-1) {
                    if (!Character.isUpperCase(builder.charAt(index_first-1))) {
                        return false;
                    }
                } else {
                    if (!(Character.isUpperCase(builder.charAt(index_first - 1)) && Character.isUpperCase(builder.charAt(index_first + 1)))) {
                        return false;
                    }
                }

            }
        }
        return true;
    }

    private static boolean check_only(StringBuilder builder, int index, int count) {

        int index_first = index;
        int index_last = builder.lastIndexOf(builder.charAt(index)+"");

        if (count == 2) {
            char key = '0';
            int twoInTwo = 0;
            int tempIndex = 0;
            for (int i = index_first+1; i < index_last; i++) {
                if (Character.isLowerCase(builder.charAt(i))) {
                    if (twoInTwo != 0) tempIndex = i;
                    twoInTwo++;

                    if (key == '0') {
                        key = builder.charAt(i);
                    } else if (builder.charAt(i) != key) {
                        return false;
                    }
                }
            }
            if (twoInTwo == 2) {
                builder = made_answer(builder, tempIndex, -1);
            }
        } else if (count > 2) {
            char key = builder.charAt(index);
            for (int i = 0; i < count; i++) {
                if (builder.charAt(index_first + (i*2)) != key) {
                    return false;
                }
            }
        }

        return true;
    }

    private static StringBuilder made_answer(StringBuilder builder, int index, int count) {

        int index_first = index;
        int index_last = builder.lastIndexOf(builder.charAt(index)+"");

        if (count == 2) {
            builder.replace(index_first, index_first+1, " ");
            builder.replace(index_last, index_last+1, " ");
        } else {

            if (index_first == 0 || index_last == builder.length()-1) {

                return new StringBuilder("invalid");
            }

            builder.replace(index_last+1, index_last+2, builder.charAt(index_last+1) + " ");

            for (int i = count-1; i >-1; i--) {
                builder.deleteCharAt(index_first + (i*2));
            }

            builder.replace(index_first-1, index_first, " " + builder.charAt(index_first-1));
        }

        return builder;
    }
}
